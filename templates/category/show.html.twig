{% extends 'base.html.twig' %}

{% block title %}
	{{ category.name }}
	- Neurogameron
{% endblock %}

{% block body %}
	<div class="container">
		<div class="page-header">
			<h1>{{ category.name }}</h1>
			<p class="page-description">Découvrez tous nos articles dans la catégorie
				{{ category.name }}</p>
		</div>


		{% if children is defined and children|length > 0 %}
			<div class="subcategory-list">
				<h2>Sous-catégories</h2>
				<div class="filter-section">
					<form method="GET" action="{{ path('app_category_show', {id: category.id}) }}" class="filter-form">
						<div class="filter-group">
							<label for="categoryFilter" class="filter-label">Filtrer par catégorie :</label>
							<select name="category" id="categoryFilter" class="filter-select" onchange="this.form.submit()">
								<option value="">Toutes les catégories</option>
								{% for child in children %}
									<option value="{{ child.id }}" {% if selectedCategory == (child.id ~ '') %} selected {% endif %}>
										{{ child.name }}
									</option>
								{% endfor %}
							</select>
						</div>
					</form>
				</div>
			</div>
		{% endif %}

		{% if articles is empty %}
			<div class="empty-state">
				<div class="empty-icon">
					<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" viewbox="0 0 16 16">
						<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
						<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
					</svg>
				</div>
				<h3>Aucun article disponible</h3>
				<p>Il n'y a pas encore d'articles publiés dans cette catégorie. Revenez bientôt !</p>
			</div>
		{% else %}
			<div class="articles-grid">
				{% for article in articles %}
					<article class="article-card">
						<div class="article-image {{ not article.imageUrl ? 'no-image' : '' }}">
							{% if article.imageUrl %}
								<img src="{{ article.imageUrl }}" alt="{{ article.title }}" loading="lazy">
							{% else %}
								<div class="placeholder-content">
									<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" viewbox="0 0 16 16">
										<path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
										<path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"/>
									</svg>
								</div>
							{% endif %}
						</div>

						<div class="article-content">
							<div class="article-meta">
								<span class="article-category">{{ article.category.name }}</span>
								<span class="article-date">{{ article.createdAt|date('d/m/Y') }}</span>
							</div>

							<h2 class="article-title">
								<a href="{{ path('app_article_show', {id: article.id}) }}">{{ article.title }}</a>
							</h2>

							<p class="article-summary">{{ article.summary|length > 150 ? article.summary|slice(0, 150) ~ '...' : article.summary }}</p>

							<div class="article-footer">
								<span class="article-author">Par
									{{ article.authorName }}</span>
								<a href="{{ path('app_article_show', {id: article.id}) }}" class="read-more">
									Lire la suite
									<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewbox="0 0 16 16">
										<path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
									</svg>
								</a>
							</div>
						</div>
					</article>
				{% endfor %}
			</div>
		{% endif %}

		<div class="category-navigation">
			<a href="{{ path('app_category') }}" class="back-link">
				<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewbox="0 0 16 16">
					<path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H14.5A.5.5 0 0 0 15 8z"/>
				</svg>
				Retour aux catégories
			</a>
		</div>
	</div>
	{% include "footer.html.twig" %}
{% endblock %}

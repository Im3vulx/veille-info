{% extends 'admin/admin_layout.html.twig' %}

{% block admin_content %}
	{# IMPORTANT: On enveloppe le contenu dans la même ID que dans le layout #}
	<turbo-frame id="admin-content">
		<section id="ensemble" data-admindashboard-target="section" data-section="overview" class="dashboard-section active">
			<h2>Vue d'ensemble</h2>
			<div class="number-card">
				<div class="total">
					<div class="top">
						<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 640 640"><path d="M320 205.3L320 514.6L320.5 514.4C375.1 491.7 433.7 480 492.8 480L512 480L512 160L492.8 160C450.6 160 408.7 168.4 369.7 184.6C352.9 191.6 336.3 198.5 320 205.3zM294.9 125.5L320 136L345.1 125.5C391.9 106 442.1 96 492.8 96L528 96C554.5 96 576 117.5 576 144L576 496C576 522.5 554.5 544 528 544L492.8 544C442.1 544 391.9 554 345.1 573.5L332.3 578.8C324.4 582.1 315.6 582.1 307.7 578.8L294.9 573.5C248.1 554 197.9 544 147.2 544L112 544C85.5 544 64 522.5 64 496L64 144C64 117.5 85.5 96 112 96L147.2 96C197.9 96 248.1 106 294.9 125.5z"/></svg>
						<div class="title">
							<p>Total des articles</p>
							<h3>{{ totalArticles }}
							</h3>
						</div>
					</div>
					<div class="bottom">
						<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 640 640"><path d="M416 224C398.3 224 384 209.7 384 192C384 174.3 398.3 160 416 160L576 160C593.7 160 608 174.3 608 192L608 352C608 369.7 593.7 384 576 384C558.3 384 544 369.7 544 352L544 269.3L374.6 438.7C362.1 451.2 341.8 451.2 329.3 438.7L224 333.3L86.6 470.6C74.1 483.1 53.8 483.1 41.3 470.6C28.8 458.1 28.8 437.8 41.3 425.3L201.3 265.3C213.8 252.8 234.1 252.8 246.6 265.3L352 370.7L498.7 224L416 224z"/></svg>
						<span>+2 cette semaine</span>
					</div>
				</div>
				<div class="public">
					<div class="top">
						<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 640 640"><path d="M566.6 214.6L470.6 310.6C458.1 323.1 437.8 323.1 425.3 310.6C412.8 298.1 412.8 277.8 425.3 265.3L466.7 224L96 224C78.3 224 64 209.7 64 192C64 174.3 78.3 160 96 160L466.7 160L425.3 118.6C412.8 106.1 412.8 85.8 425.3 73.3C437.8 60.8 458.1 60.8 470.6 73.3L566.6 169.3C579.1 181.8 579.1 202.1 566.6 214.6zM169.3 566.6L73.3 470.6C60.8 458.1 60.8 437.8 73.3 425.3L169.3 329.3C181.8 316.8 202.1 316.8 214.6 329.3C227.1 341.8 227.1 362.1 214.6 374.6L173.3 416L544 416C561.7 416 576 430.3 576 448C576 465.7 561.7 480 544 480L173.3 480L214.7 521.4C227.2 533.9 227.2 554.2 214.7 566.7C202.2 579.2 181.9 579.2 169.4 566.7z"/></svg>
						<div class="title">
							<p>Articles publiés</p>
							<h3>{{ countarticles }}</h3>
						</div>
					</div>
					<div class="bottom">
						<span>100% du total</span>
					</div>
				</div>
				<div class="categories">
					<div class="top">
						<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 640 640"><path d="M96.5 160L96.5 309.5C96.5 326.5 103.2 342.8 115.2 354.8L307.2 546.8C332.2 571.8 372.7 571.8 397.7 546.8L547.2 397.3C572.2 372.3 572.2 331.8 547.2 306.8L355.2 114.8C343.2 102.7 327 96 310 96L160.5 96C125.2 96 96.5 124.7 96.5 160zM208.5 176C226.2 176 240.5 190.3 240.5 208C240.5 225.7 226.2 240 208.5 240C190.8 240 176.5 225.7 176.5 208C176.5 190.3 190.8 176 208.5 176z"/></svg>
						<div class="title">
							<p>Catégories</p>
							<h3>{{ categoriesCount }}</h3>
						</div>
					</div>
					<div class="bottom">
						<span>1 articles par catégrorie en moyenne</span>
					</div>
				</div>
			</div>

			<div class="container">
				<div class="left">
					<h3>Articles récents</h3>
					{% for article in latestArticles %}
						<div class="articles">
							<div class="img">
								{% if article.imageUrl is not empty %}
									<img src="{{ article.imageUrl }}" alt="{{ article.title }}" loading="lazy">
								{% else %}
									<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 640 640"><path d="M160 96C124.7 96 96 124.7 96 160L96 480C96 515.3 124.7 544 160 544L480 544C515.3 544 544 515.3 544 480L544 160C544 124.7 515.3 96 480 96L160 96zM224 176C250.5 176 272 197.5 272 224C272 250.5 250.5 272 224 272C197.5 272 176 250.5 176 224C176 197.5 197.5 176 224 176zM368 288C376.4 288 384.1 292.4 388.5 299.5L476.5 443.5C481 450.9 481.2 460.2 477 467.8C472.8 475.4 464.7 480 456 480L184 480C175.1 480 166.8 475 162.7 467.1C158.6 459.2 159.2 449.6 164.3 442.3L220.3 362.3C224.8 355.9 232.1 352.1 240 352.1C247.9 352.1 255.2 355.9 259.7 362.3L286.1 400.1L347.5 299.6C351.9 292.5 359.6 288.1 368 288.1z"/></svg>
								{% endif %}
							</div>
							<div class="texte">
								<div class="info">
									<h4>{{ article.title }}</h4>
									<p>{{ article.createdAt|date('d/m/Y') }}</p>
								</div>
								<div class="statue">
									{% if article.published == 1 %}
										<p class="publie">Publié</p>
									{% else %}
										<p class="brouillon">Brouillon</p>
									{% endif %}
								</div>
							</div>
						</div>
					{% endfor %}
					<a href="{{ path('app_admin_articles') }}">Voir tous les articles</a>
				</div>
				<div class="right">
					<h3>Articles par catégorie</h3>
					<div class="category-progress-list">
						{% for cat in topCategories %}
							{% set percent = (cat.article_count / maxCount * 100)|round(0, 'floor') %}

							<div class="category-item">
								<div class="category-header">
									<span class="category-name">{{ cat.category_name }}</span>
									<span class="category-value">{{ cat.article_count }}
										articles</span>
								</div>

								<div class="progress-bar">
									<div class="progress-fill" style="width: {{ percent }}%;"></div>
								</div>
							</div>
						{% else %}
							<p>Aucune catégorie trouvée.</p>
						{% endfor %}
					</div>
				</div>
			</div>
		</section>
	</turbo-frame>
{% endblock %}
